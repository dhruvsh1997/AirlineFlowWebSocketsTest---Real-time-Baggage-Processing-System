# ğŸ›« AirlineFlowWSTest - Real-time Baggage Processing System

A FastAPI-based WebSocket application that simulates real-time airline baggage processing with live status updates. This project demonstrates the implementation of WebSocket connections for real-time communication between server and client.

## ğŸ“‹ Table of Contents

- [Overview](#overview)
- [Features](#features)
- [Technology Stack](#technology-stack)
- [System Architecture](#system-architecture)
- [Understanding WebSockets vs API Polling](#understanding-websockets-vs-api-polling)
- [Project Structure](#project-structure)
- [Installation](#installation)
- [Usage](#usage)
- [API Endpoints](#api-endpoints)
- [WebSocket Events](#websocket-events)
- [Deployment](#deployment)
- [Contributing](#contributing)

## ğŸ” Overview

This application simulates an airline baggage processing system that tracks baggage through various stages from check-in to aircraft loading. It uses WebSocket technology to provide real-time updates to connected clients about the processing status.

### Key Components:
- **FastAPI Backend**: Handles HTTP requests and WebSocket connections
- **WebSocket Manager**: Manages multiple concurrent WebSocket connections
- **Task Simulation**: Simulates baggage processing with realistic timing
- **Real-time Updates**: Broadcasts status changes to all connected clients

## âœ¨ Features

- ğŸ”„ **Real-time Status Updates**: Live baggage processing status via WebSockets
- ğŸ¯ **Multi-client Support**: Multiple clients can track the same baggage
- ğŸ“Š **Progress Tracking**: Visual progress indication through processing stages
- ğŸ·ï¸ **Unique Task IDs**: Each baggage processing task has a unique identifier
- ğŸ”„ **Automatic Reconnection**: Robust connection handling with error recovery
- ğŸ“± **RESTful API**: HTTP endpoints for task creation and status checking
- ğŸ¨ **Interactive Dashboard**: Beautiful HTML interface for status monitoring

## ğŸ› ï¸ Technology Stack

- **Backend Framework**: FastAPI 0.104.1
- **WebSocket Library**: Native FastAPI WebSocket support
- **ASGI Server**: Uvicorn with standard extras
- **Language**: Python 3.11+
- **Frontend**: HTML5, CSS3, JavaScript (WebSocket API)
- **Containerization**: Docker
- **CI/CD**: GitHub Actions

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTP POST     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client Apps   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚   FastAPI App    â”‚
â”‚                 â”‚                  â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    WebSocket     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Dashboard 1â”‚  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  â”‚ Connection  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    Connection    â”‚  â”‚  Manager    â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚Dashboard 2â”‚  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚  â”‚   Task      â”‚ â”‚
â”‚  â”‚Dashboard Nâ”‚  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  â”‚ Processing  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚  â”‚  Engine     â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Flow Diagram

```mermaid
graph TD
    A[Client] -->|POST /process| B[FastAPI Server]
    B -->|Generate Task ID| C[Task Creation]
    C -->|Start Background Task| D[Baggage Processing Simulation]
    B -->|Return Task ID & WebSocket URL| A
    A -->|Connect to WebSocket| E[WebSocket Connection Manager]
    D -->|Status Updates| F[Task Status Dictionary]
    F -->|Broadcast Updates| E
    E -->|Real-time Updates| A
    
    subgraph "Processing Stages"
        G[Baggage Check-in]
        H[Security Screening]
        I[Baggage Sorting]
        J[Loading onto Aircraft]
        K[Processing Complete]
        G --> H --> I --> J --> K
    end
    
    D --> G
```

## ğŸ”„ Understanding WebSockets vs API Polling

### Traditional API Polling Approach

In traditional web applications, clients need to repeatedly request server updates:

```
Client                    Server
  â”‚                        â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€ GET /status â”€â”€â”€â”€â–ºâ”‚
  â”‚â—„â”€â”€â”€â”€ Response Data â”€â”€â”€â”€â”‚
  â”‚                        â”‚
  â”‚â”€ Wait (e.g., 5 seconds)â”€â”‚
  â”‚                        â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€ GET /status â”€â”€â”€â”€â–ºâ”‚
  â”‚â—„â”€â”€â”€â”€ Response Data â”€â”€â”€â”€â”‚
  â”‚                        â”‚
  â””â”€ Repeat every N secondsâ”€â”˜
```

**Drawbacks of API Polling:**
- âš¡ **High Latency**: Updates delayed by polling interval
- ğŸ”„ **Resource Wasteful**: Many unnecessary requests when no updates
- ğŸ“Š **Poor UX**: Choppy, non-real-time experience
- ğŸ’¸ **High Server Load**: Constant HTTP requests consume resources

### WebSocket Approach

WebSockets provide a persistent, bidirectional connection:

```
Client                    Server
  â”‚                        â”‚
  â”‚â”€â”€â”€â”€ WebSocket Handshake â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚â—„â”€â”€â”€ Connection Established â”€â”€â”€â”‚
  â”‚                        â”‚
  â”‚â—„â”€â”€â”€â”€ Live Update 1 â”€â”€â”€â”€â”‚
  â”‚â—„â”€â”€â”€â”€ Live Update 2 â”€â”€â”€â”€â”‚
  â”‚â—„â”€â”€â”€â”€ Live Update 3 â”€â”€â”€â”€â”‚
  â”‚                        â”‚
  â””â”€â”€ Persistent Connection â”€â”˜
```

**Benefits of WebSockets:**
- âš¡ **Real-time Updates**: Instant data push from server
- ğŸš€ **Efficient**: No repeated handshakes or headers
- ğŸ“± **Better UX**: Smooth, live updates
- ğŸ’° **Cost-effective**: Lower server resource usage

### Performance Comparison

| Aspect | API Polling | WebSockets |
|--------|-------------|------------|
| **Latency** | High (polling interval) | Near-zero |
| **Server Load** | High (constant requests) | Low (persistent connection) |
| **Network Overhead** | High (HTTP headers) | Low (minimal frame overhead) |
| **Real-time Experience** | Poor | Excellent |
| **Complexity** | Simple | Moderate |

## ğŸ“ Project Structure

```
AirlineFlowWSTest/
â”œâ”€â”€ app.py                 # Main FastAPI application
â”œâ”€â”€ templates/             # HTML templates
â”‚   â””â”€â”€ weather_dashboard.html
â”œâ”€â”€ requirements.txt       # Python dependencies
â”œâ”€â”€ Dockerfile            # Container configuration
â”œâ”€â”€ .gitignore           # Git ignore rules
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ ci_cd.yml    # GitHub Actions CI/CD
â””â”€â”€ README.md           # Project documentation
```

## ğŸš€ Installation

### Prerequisites

- Python 3.11 or higher
- pip package manager
- Git

### Local Development Setup

1. **Clone the repository:**
   ```bash
   git clone https://github.com/yourusername/AirlineFlowWSTest.git
   cd AirlineFlowWSTest
   ```

2. **Create virtual environment:**
   ```bash
   python -m venv envAirlineWS
   
   # Windows
   envAirlineWS\Scripts\activate
   
   # macOS/Linux
   source envAirlineWS/bin/activate
   ```

3. **Install dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

4. **Run the application:**
   ```bash
   uvicorn app:app --reload --port 7000
   ```

5. **Access the application:**
   - API: http://localhost:7000
   - Documentation: http://localhost:7000/docs

### Docker Setup

1. **Build the Docker image:**
   ```bash
   docker build -t airlineflowws .
   ```

2. **Run the container:**
   ```bash
   docker run -p 8000:8000 airlineflowws
   ```

## ğŸ“– Usage

### Starting a Baggage Processing Task

1. **Create a new processing task:**
   ```bash
   curl -X POST http://localhost:7000/process
   ```

   **Response:**
   ```json
   {
     "task_id": "123e4567-e89b-12d3-a456-426614174000",
     "message": "Baggage processing started",
     "websocket_url": "/ws/status/123e4567-e89b-12d3-a456-426614174000",
     "instruction": "Connect to the WebSocket URL to receive real-time status updates"
   }
   ```

2. **Connect to WebSocket for real-time updates:**
   ```javascript
   const ws = new WebSocket('ws://localhost:7000/ws/status/123e4567-e89b-12d3-a456-426614174000');
   
   ws.onmessage = function(event) {
     const data = JSON.parse(event.data);
     console.log('Status Update:', data);
   };
   ```

### Processing Stages

The baggage processing simulation goes through these stages:

1. **Baggage Check-in** (20-30 seconds)
2. **Security Screening** (25-35 seconds)
3. **Baggage Sorting** (20-30 seconds)
4. **Loading onto Aircraft** (25-35 seconds)
5. **Processing Complete**

## ğŸŒ API Endpoints

### HTTP Endpoints

| Method | Endpoint | Description | Response |
|--------|----------|-------------|----------|
| `GET` | `/` | Root endpoint | Welcome message |
| `POST` | `/process` | Start new baggage processing | Task ID and WebSocket URL |
| `GET` | `/status/{task_id}` | Get current task status (HTTP fallback) | Task status object |

### WebSocket Endpoints

| Endpoint | Description |
|----------|-------------|
| `/ws/status/{task_id}` | Real-time status updates for specific task |

## ğŸ“¡ WebSocket Events

### Connection Events

- **Connection Established**: Client receives immediate current status
- **Status Updates**: Real-time processing stage updates
- **Error Handling**: Automatic reconnection on connection loss
- **Disconnection**: Clean removal from connection pool

### Message Format

```json
{
  "task_id": "123e4567-e89b-12d3-a456-426614174000",
  "stage": 2,
  "stage_name": "Baggage Sorting",
  "progress": 50,
  "status": "Processing",
  "start_time": "2024-01-15T10:30:00.000Z",
  "estimated_completion": 1705320720,
  "baggage_details": {
    "baggage_id": "BAG-12345",
    "flight_number": "FL-789",
    "destination": "New York",
    "weight": "23.5 kg",
    "priority": "Normal"
  }
}
```

## ğŸ³ Deployment

### Docker Deployment

```bash
# Build and run
docker build -t airlineflowws .
docker run -d -p 8000:8000 --name airline-app airlineflowws
```

### Production Considerations

1. **Environment Variables**: Set up proper environment configuration
2. **Load Balancing**: Configure sticky sessions for WebSocket connections
3. **Monitoring**: Implement health checks and logging
4. **Security**: Add authentication and rate limiting
5. **Scalability**: Consider using Redis for connection management across instances

### GitHub Actions CI/CD

The project includes a complete CI/CD pipeline that:

1. **Tests**: Runs automated tests on push/PR
2. **Linting**: Checks code quality with flake8
3. **Build**: Creates Docker images
4. **Deploy**: Automates deployment (configure based on your needs)

## ğŸ”§ Configuration

### Environment Variables

Create a `.env` file for local development:

```env
# Server Configuration
HOST=0.0.0.0
PORT=7000
DEBUG=True

# WebSocket Configuration
MAX_CONNECTIONS_PER_TASK=100
TASK_CLEANUP_DELAY=300

# Processing Configuration
MIN_STAGE_DURATION=20
MAX_STAGE_DURATION=35
```

## ğŸ“Š Monitoring and Logging

The application includes built-in monitoring features:

- **Connection Tracking**: Monitor active WebSocket connections
- **Task Management**: Track processing tasks and their lifecycle
- **Error Handling**: Robust error handling with graceful degradation
- **Performance Metrics**: Monitor processing times and connection counts

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

### Development Guidelines

- Follow PEP 8 style guidelines
- Add tests for new features
- Update documentation as needed
- Ensure Docker builds successfully

## ğŸ“„ License

This project is licensed under the MIT License - see the LICENSE file for details.

## ğŸ™ Acknowledgments

- FastAPI team for the excellent framework
- WebSocket RFC authors for the protocol specification
- Contributors and testers who helped improve this project

## ğŸ“ Support

If you encounter any issues or have questions:

1. Check the [GitHub Issues](https://github.com/yourusername/AirlineFlowWSTest/issues)
2. Create a new issue with detailed information
3. Join our community discussions

---

**Built with â¤ï¸ using FastAPI and WebSockets**